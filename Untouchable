#Importando e iniciando biblioteca
import pygame
pygame.init()
#Criando tela e cores
tela = pygame.display.set_mode([600, 600])
pygame.display.set_caption('Intocável')
vermelho = (255, 0, 0)
verde = (0, 255, 0)
azul = (0, 0, 255)
branco = (255, 255, 255)
preto = (0, 0, 0)
laranja = (255, 165, 0)
fundo_tela = azul
fps = 60
circulo_x = 300
circulo_y = 300
circulo_x_direc = 4
circulo_y_direc = 5
largura_jogador = 30
altura_jogador = 50
jogador_x = 300
jogador_y = 500
direcao_x_jogador = 0
direcao_y_jogador = 0
velocidade_jogador = 3
fonte = pygame.font.Font('freesansbold.ttf', 20)
fonte_game_over = pygame.font.Font('freesansbold.ttf', 60)
score = 0
recorde_anterior = 0
recorde = 0
timer = pygame.time.Clock()

gameover = False

def checar_colisao(jogador_x, jogador_y, bola_x, bola_y):
    if abs(jogador_x - bola_x) < 44 and abs(jogador_y - bola_y) < 54:
        global direcao_x_jogador
        global direcao_y_jogador
        global circulo_x_direc
        global circulo_y_direc
        direcao_x_jogador = 0
        direcao_y_jogador = 0
        circulo_x_direc = 0
        circulo_y_direc = 0
        game_over()


def game_over():
    global gameover
    display_game_over = fonte_game_over.render('GAME OVER', True, vermelho, preto)
    tela.blit(display_game_over, (70, 300))
    display_restart = fonte.render('Aperte Espaço para Recomeçar', True, branco, preto)
    tela.blit(display_restart, (170, 450))
    gameover = True


def atualizar_posicao_jogador():
    global jogador_x
    global jogador_y
    global direcao_x_jogador
    global direcao_y_jogador
    if direcao_x_jogador > 0:
        if jogador_x < 600 - largura_jogador:
            jogador_x += direcao_x_jogador * velocidade_jogador
    if direcao_x_jogador < 0:
        if jogador_x > 0:
            jogador_x += direcao_x_jogador * velocidade_jogador
    if direcao_y_jogador > 0:
        if jogador_y < 600 - altura_jogador:
            jogador_y += direcao_y_jogador * velocidade_jogador
    if direcao_y_jogador < 0:
        if jogador_y > 0:
            jogador_y += direcao_y_jogador * velocidade_jogador
def atualizar_posicao_bola():
    global circulo_x 
    global circulo_y 
    global circulo_x_direc
    global circulo_y_direc 
    global score
    if circulo_x_direc > 0:
        if circulo_x < 570:
            circulo_x += circulo_x_direc
        else:
            circulo_x_direc *= -1
            score += 1
    elif circulo_x_direc < 0:
        if circulo_x > 30:
            circulo_x += circulo_x_direc
        else:
            circulo_x_direc *= -1
            score += 1
    if circulo_y_direc > 0:
        if circulo_y < 570:
            circulo_y += circulo_y_direc
        else:
            circulo_y_direc *= -1
            score += 1
    elif circulo_y_direc < 0:
        if circulo_y > 30:
            circulo_y += circulo_y_direc
        else:
            circulo_y_direc *= -1
            score += 1
#Loop do jogo
rodando = True
while rodando:
    timer.tick(fps)
    atualizar_posicao_bola()
    atualizar_posicao_jogador()
    for evento in pygame.event.get():
        if evento.type == pygame.QUIT:
            rodando = False
        if evento.type == pygame.KEYDOWN:
            if evento.key == pygame.K_LEFT:
                direcao_x_jogador = -1
            if evento.key == pygame.K_RIGHT:
                direcao_x_jogador = 1
            if evento.key == pygame.K_UP:
                direcao_y_jogador = -1
            if evento.key == pygame.K_DOWN:
                direcao_y_jogador = 1
        if evento.type == pygame.KEYUP:
            if evento.key == pygame.K_LEFT:
                direcao_x_jogador = 0
            if evento.key == pygame.K_RIGHT:
                direcao_x_jogador = 0
            if evento.key == pygame.K_UP:
                direcao_y_jogador = 0
            if evento.key == pygame.K_DOWN:
                direcao_y_jogador = 0
            if evento.key == pygame.K_SPACE and gameover:
                circulo_x = 300
                circulo_y = 300
                circulo_x_direc = 4
                circulo_y_direc = 5
                jogador_x = 300
                jogador_y = 500
                recorde_anterior = score
                if score > recorde:
                    recorde = score
                score = 0
                gameover = False



    tela.fill((fundo_tela))
    bola = pygame.draw.circle(tela, verde, (circulo_x, circulo_y), 30, 5)
    pygame.draw.circle(tela, vermelho, (circulo_x, circulo_y), 25)
    jogador = pygame.draw.rect(tela, laranja, [jogador_x, jogador_y, largura_jogador, altura_jogador])
    checar_colisao(jogador.centerx, jogador.centery, bola.centerx, bola.centery)
    display_score = fonte.render('Score: '+ str(score), True, branco, preto)
    tela.blit(display_score, (10, 10))
    display_recorde_anterior = fonte.render('Last Score: '+ str(recorde_anterior), True, branco, preto)
    tela.blit(display_recorde_anterior, (10, 30))
    display_recorde = fonte.render('High Score: '+ str(recorde), True, branco, preto)
    tela.blit(display_recorde, (10, 50))
    pygame.display.flip()

#Encerrando a biblioteca
pygame.quit()